from typing import List, Dict, Optional
from bs4 import BeautifulSoup
import re
import sys
from pathlib import Path

sys.path.insert(0, str(Path(__file__).parent.parent))
from utils.dedup import slugify
from utils.ai_enhancer import get_enhancer

def clean_html(html: str) -> str:
    """Extract plain text from HTML for summaries/descriptions"""
    if not html:
        return ''

    soup = BeautifulSoup(html, 'html.parser')

    # Remove script and style tags
    for tag in soup(['script', 'style', 'iframe']):
        tag.decompose()

    text = soup.get_text(separator=' ', strip=True)
    # Clean extra whitespace
    text = re.sub(r'\s+', ' ', text)
    return text.strip()
